// Ï†ÑÏÑ∏Í≥Ñ Íµ≠Í∞ÄÏôÄ ÏàòÎèÑ Îç∞Ïù¥ÌÑ∞ (Ïú†Î™ÖÌïú ÎèÑÏãúÎì§ Ìè¨Ìï®)
const countries = [
    {name: "ÎåÄÌïúÎØºÍµ≠", capital: "ÏÑúÏö∏", flag: "üá∞üá∑", cities: ["ÏÑúÏö∏", "Î∂ÄÏÇ∞", "Ïù∏Ï≤ú", "ÎåÄÍµ¨"]},
    {name: "ÌîÑÎûëÏä§", capital: "ÌååÎ¶¨", flag: "üá´üá∑", cities: ["ÌååÎ¶¨", "ÎßàÎ•¥ÏÑ∏Ïú†", "Î¶¨Ïòπ", "Ìà¥Î£®Ï¶à"]},
    {name: "Î∏åÎùºÏßà", capital: "Î∏åÎùºÏßàÎ¶¨ÏïÑ", flag: "üáßüá∑", cities: ["Î∏åÎùºÏßàÎ¶¨ÏïÑ", "ÏÉÅÌååÏö∏Î£®", "Î¶¨Ïö∞Îç∞ÏûêÎÑ§Ïù¥Î£®", "ÏÇ¥Î∞îÎèÑÎ•¥"]},
    {name: "Ìò∏Ï£º", capital: "Ï∫îÎ≤ÑÎùº", flag: "üá¶üá∫", cities: ["ÏãúÎìúÎãà", "Ï∫îÎ≤ÑÎùº", "Î©úÎ≤ÑÎ•∏", "Î∏åÎ¶¨Ï¶àÎ≤à"]},
    {name: "ÏùºÎ≥∏", capital: "ÎèÑÏøÑ", flag: "üáØüáµ", cities: ["ÎèÑÏøÑ", "ÍµêÌÜ†", "Ïò§ÏÇ¨Ïπ¥", "ÎÇòÍ≥†Ïïº"]},
    {name: "Ï§ëÍµ≠", capital: "Î≤†Ïù¥Ïßï", flag: "üá®üá≥", cities: ["Î≤†Ïù¥Ïßï", "ÏÉÅÌïòÏù¥", "Í¥ëÏ†ÄÏö∞", "ÏÑ†Ï†Ñ"]},
    {name: "ÎØ∏Íµ≠", capital: "ÏõåÏã±ÌÑ¥ D.C.", flag: "üá∫üá∏", cities: ["ÏõåÏã±ÌÑ¥ D.C.", "Îâ¥Ïöï", "Î°úÏä§Ïï§Ï†§Î†àÏä§", "ÏãúÏπ¥Í≥†"]},
    {name: "ÏòÅÍµ≠", capital: "Îü∞Îçò", flag: "üá¨üáß", cities: ["Îü∞Îçò", "Îß®Ï≤¥Ïä§ÌÑ∞", "Î≤ÑÎ∞çÏóÑ", "Î¶¨Î≤ÑÌíÄ"]},
    {name: "ÎèÖÏùº", capital: "Î≤†Î•ºÎ¶∞", flag: "üá©üá™", cities: ["Î≤†Î•ºÎ¶∞", "ÎÆåÌó®", "Ìï®Î∂ÄÎ•¥ÌÅ¨", "Ïæ∞Î•∏"]},
    {name: "Ïù¥ÌÉàÎ¶¨ÏïÑ", capital: "Î°úÎßà", flag: "üáÆüáπ", cities: ["Î°úÎßà", "Î∞ÄÎùºÎÖ∏", "ÎÇòÌè¥Î¶¨", "ÌÜ†Î¶¨ÎÖ∏"]},
    {name: "Ïä§ÌéòÏù∏", capital: "ÎßàÎìúÎ¶¨Îìú", flag: "üá™üá∏", cities: ["ÎßàÎìúÎ¶¨Îìú", "Î∞îÎ•¥ÏÖÄÎ°úÎÇò", "Î∞úÎ†åÏãúÏïÑ", "ÏÑ∏ÎπÑÏïº"]},
    {name: "Îü¨ÏãúÏïÑ", capital: "Î™®Ïä§ÌÅ¨Î∞î", flag: "üá∑üá∫", cities: ["Î™®Ïä§ÌÅ¨Î∞î", "ÏÉÅÌä∏ÌéòÌÖåÎ•¥Î∂ÄÎ•¥ÌÅ¨", "ÎÖ∏Î≥¥ÏãúÎπÑÎ•¥Ïä§ÌÅ¨", "ÏòàÏπ¥ÌÖåÎ¶∞Î∂ÄÎ•¥ÌÅ¨"]},
    {name: "Ïù∏ÎèÑ", capital: "Îâ¥Îç∏Î¶¨", flag: "üáÆüá≥", cities: ["Îâ¥Îç∏Î¶¨", "Î≠ÑÎ∞îÏù¥", "ÏΩúÏπ¥ÌÉÄ", "Î∞©Í∞àÎ°úÎ•¥"]},
    {name: "Ï∫êÎÇòÎã§", capital: "Ïò§ÌÉÄÏôÄ", flag: "üá®üá¶", cities: ["Ïò§ÌÉÄÏôÄ", "ÌÜ†Î°†ÌÜ†", "Î™¨Ìä∏Î¶¨Ïò¨", "Î∞¥Ïø†Î≤Ñ"]},
    {name: "Î©ïÏãúÏΩî", capital: "Î©ïÏãúÏΩîÏãúÌã∞", flag: "üá≤üáΩ", cities: ["Î©ïÏãúÏΩîÏãúÌã∞", "Í≥ºÎã¨ÎùºÌïòÎùº", "Î™¨ÌÖåÎ†àÏù¥", "Ìë∏ÏóêÎ∏îÎùº"]},
    {name: "ÏïÑÎ•¥Ìó®Ìã∞ÎÇò", capital: "Î∂ÄÏóêÎÖ∏Ïä§ÏïÑÏù¥Î†àÏä§", flag: "üá¶üá∑", cities: ["Î∂ÄÏóêÎÖ∏Ïä§ÏïÑÏù¥Î†àÏä§", "ÏΩîÎ•¥ÎèÑÎ∞î", "Î°úÏÇ¨Î¶¨Ïò§", "Î©òÎèÑÏÇ¨"]},
    {name: "Ïù¥ÏßëÌä∏", capital: "Ïπ¥Ïù¥Î°ú", flag: "üá™üá¨", cities: ["Ïπ¥Ïù¥Î°ú", "ÏïåÎ†âÏÇ∞ÎìúÎ¶¨ÏïÑ", "Í∏∞Ïûê", "ÏàòÏóêÏ¶à"]},
    {name: "ÎÇ®ÏïÑÌîÑÎ¶¨Ïπ¥Í≥µÌôîÍµ≠", capital: "ÌîÑÎ¶¨ÌÜ†Î¶¨ÏïÑ", flag: "üáøüá¶", cities: ["ÌîÑÎ¶¨ÌÜ†Î¶¨ÏïÑ", "ÏöîÌïòÎÑ§Ïä§Î≤ÑÍ∑∏", "ÏºÄÏù¥ÌîÑÌÉÄÏö¥", "ÎçîÎ∞ò"]},
    {name: "ÌÉúÍµ≠", capital: "Î∞©ÏΩï", flag: "üáπüá≠", cities: ["Î∞©ÏΩï", "ÏπòÏïôÎßàÏù¥", "ÌååÌÉÄÏïº", "Ìë∏Ïºì"]},
    {name: "Î≤†Ìä∏ÎÇ®", capital: "ÌïòÎÖ∏Ïù¥", flag: "üáªüá≥", cities: ["ÌïòÎÖ∏Ïù¥", "Ìò∏ÏπòÎØºÏãú", "Îã§ÎÇ≠", "ÌïòÏù¥ÌêÅ"]},
    {name: "Ïù∏ÎèÑÎÑ§ÏãúÏïÑ", capital: "ÏûêÏπ¥Î•¥ÌÉÄ", flag: "üáÆüá©", cities: ["ÏûêÏπ¥Î•¥ÌÉÄ", "ÏàòÎùºÎ∞îÏïº", "Î∞òÎë•", "Î©îÎã®"]},
    {name: "ÌÑ∞ÌÇ§", capital: "ÏïôÏπ¥Îùº", flag: "üáπüá∑", cities: ["ÏïôÏπ¥Îùº", "Ïù¥Ïä§ÌÉÑÎ∂à", "Ïù¥Ï¶àÎØ∏Î•¥", "Î∂ÄÎ•¥ÏÇ¨"]},
    {name: "Í∑∏Î¶¨Ïä§", capital: "ÏïÑÌÖåÎÑ§", flag: "üá¨üá∑", cities: ["ÏïÑÌÖåÎÑ§", "ÌÖåÏÇ¥Î°úÎãàÌÇ§", "ÌååÌä∏Îùº", "Ïù¥ÎùºÌÅ¥Î¶¨Ïò§"]},
    {name: "ÎÑ§ÎçúÎûÄÎìú", capital: "ÏïîÏä§ÌÖåÎ•¥Îã¥", flag: "üá≥üá±", cities: ["ÏïîÏä§ÌÖåÎ•¥Îã¥", "Î°úÌÖåÎ•¥Îã¥", "Ìó§Ïù¥Í∑∏", "ÏúÑÌä∏Î†àÌùêÌä∏"]},
    {name: "Î≤®Í∏∞Ïóê", capital: "Î∏åÎ§ºÏÖÄ", flag: "üáßüá™", cities: ["Î∏åÎ§ºÏÖÄ", "ÏïàÌä∏Î≤†Î•¥Ìéú", "Í≤êÌä∏", "Î∏åÎ§ºÌó§"]},
    {name: "Ïä§ÏúÑÏä§", capital: "Î≤†Î•∏", flag: "üá®üá≠", cities: ["Î≤†Î•∏", "Ï∑®Î¶¨Ìûà", "Ï†úÎÑ§Î∞î", "Î∞îÏ†§"]},
    {name: "Ïä§Ïõ®Îç¥", capital: "Ïä§ÌÜ°ÌôÄÎ¶Ñ", flag: "üá∏üá™", cities: ["Ïä§ÌÜ°ÌôÄÎ¶Ñ", "ÏòàÌÖåÎ≥¥Î¶¨", "ÎßêÎ´º", "ÏõÅÏÇ¥Îùº"]},
    {name: "ÎÖ∏Î•¥Ïõ®Ïù¥", capital: "Ïò§Ïä¨Î°ú", flag: "üá≥üá¥", cities: ["Ïò§Ïä¨Î°ú", "Î≤†Î•¥Í≤ê", "Ìä∏Î°†Ìó§ÏûÑ", "Ïä§ÌÉÄÎ∞©ÏóêÎ•¥"]},
    {name: "Îç¥ÎßàÌÅ¨", capital: "ÏΩîÌéúÌïòÍ≤ê", flag: "üá©üá∞", cities: ["ÏΩîÌéúÌïòÍ≤ê", "Ïò§Î•¥ÌõÑÏä§", "Ïò§Îç¥ÏÑ∏", "Ïò¨Î≥¥Î•¥"]},
    {name: "ÌïÄÎûÄÎìú", capital: "Ìó¨Ïã±ÌÇ§", flag: "üá´üáÆ", cities: ["Ìó¨Ïã±ÌÇ§", "ÏóêÏä§Ìè¨", "ÌÉêÌéòÎ†à", "Î∞òÌÉÄ"]},
    {name: "ÎÇòÏù¥ÏßÄÎ¶¨ÏïÑ", capital: "ÏïÑÎ∂ÄÏûê", flag: "üá≥üá¨", cities: ["ÏïÑÎ∂ÄÏûê", "ÎùºÍ≥†Ïä§", "Ïπ¥ÎÖ∏", "Ïù¥Î∞îÎã®"]},
    {name: "Îâ¥ÏßàÎûúÎìú", capital: "Ïõ∞ÎßÅÌÑ¥", flag: "üá≥üáø", cities: ["Ïõ∞ÎßÅÌÑ¥", "Ïò§ÌÅ¥ÎûúÎìú", "ÌÅ¨ÎùºÏù¥Ïä§Ìä∏Ï≤òÏπò", "Ìï¥Î∞ÄÌÑ¥"]},
    {name: "Ïò§Ïä§Ìä∏Î¶¨ÏïÑ", capital: "ÎπÑÏóîÎÇò", flag: "üá¶üáπ", cities: ["ÎπÑÏóîÎÇò", "Í∑∏ÎùºÏ∏†", "Î¶∞Ï∏†", "ÏûòÏ∏†Î∂ÄÎ•¥ÌÅ¨"]},
    {name: "Ïπ†Î†à", capital: "ÏÇ∞Ìã∞ÏïÑÍ≥†", flag: "üá®üá±", cities: ["ÏÇ∞Ìã∞ÏïÑÍ≥†", "Î∞úÌååÎùºÏù¥ÏÜå", "ÏΩòÏÖâÏãúÏò®", "ÏïàÌÜ†ÌååÍ∞ÄÏä§ÌÉÄ"]},
    {name: "ÏΩúÎ°¨ÎπÑÏïÑ", capital: "Î≥¥Í≥†ÌÉÄ", flag: "üá®üá¥", cities: ["Î≥¥Í≥†ÌÉÄ", "Î©îÎç∞Ïù∏", "ÏπºÎ¶¨", "Î∞îÎûëÌÇ§Ïïº"]},
    {name: "Ï≤¥ÏΩî", capital: "ÌîÑÎùºÌïò", flag: "üá®üáø", cities: ["ÌîÑÎùºÌïò", "Î∏åÎ•¥ÎÖ∏", "Ïò§Ïä§Ìä∏ÎùºÎ∞î", "ÌîåÏ††"]},
    {name: "ÌóùÍ∞ÄÎ¶¨", capital: "Î∂ÄÎã§ÌéòÏä§Ìä∏", flag: "üá≠üá∫", cities: ["Î∂ÄÎã§ÌéòÏä§Ìä∏", "Îç∞Î∏åÎ†àÏ≤∏", "ÏÑ∏Í≤åÎìú", "ÎØ∏ÏäàÏΩúÏ∏†"]},
    {name: "ÏïÑÏù¥Ïä¨ÎûÄÎìú", capital: "Î†àÏù¥Ï∫¨ÎπÑÌÅ¨", flag: "üáÆüá∏", cities: ["Î†àÏù¥Ï∫¨ÎπÑÌÅ¨", "ÏΩîÌååÎ≥¥Í∑ÄÎ•¥", "ÌïòÌîÑÎÇòÎ•¥ÌîºÏô∏Î•¥Îí§Î•¥", "ÏïÑÌÄ¥Î†àÏù¥Î¶¨"]},
    {name: "ÏïÑÏùºÎûúÎìú", capital: "ÎçîÎ∏îÎ¶∞", flag: "üáÆüá™", cities: ["ÎçîÎ∏îÎ¶∞", "ÏΩîÌÅ¨", "Î¶¨Î®∏Î¶≠", "Í≥®Ïõ®Ïù¥"]},
    {name: "Ïπ¥ÏûêÌùêÏä§ÌÉÑ", capital: "ÏïÑÏä§ÌÉÄÎÇò", flag: "üá∞üáø", cities: ["ÏïÑÏä§ÌÉÄÎÇò", "ÏïåÎßàÌã∞", "ÏâºÏºÑÌä∏", "Ïπ¥ÎùºÍ∞ÑÎã§"]},
    {name: "ÏºÄÎÉê", capital: "ÎÇòÏù¥Î°úÎπÑ", flag: "üá∞üá™", cities: ["ÎÇòÏù¥Î°úÎπÑ", "Î™∏Î∞îÏÇ¨", "ÌÇ§ÏàòÎ¨¥", "ÎÇòÏø†Î£®"]},
    {name: "ÎßêÎ†àÏù¥ÏãúÏïÑ", capital: "Ïø†ÏïåÎùºÎ£∏Ìë∏Î•¥", flag: "üá≤üáæ", cities: ["Ïø†ÏïåÎùºÎ£∏Ìë∏Î•¥", "Ï°∞ÏßÄÌÉÄÏö¥", "Ïù¥Ìè¨", "Ï°∞Ìò∏Î•¥Î∞îÎ£®"]},
    {name: "Î™®Î°úÏΩî", capital: "ÎùºÎ∞îÌä∏", flag: "üá≤üá¶", cities: ["ÎùºÎ∞îÌä∏", "Ïπ¥ÏÇ¨Î∏îÎûëÏπ¥", "ÌéòÏä§", "ÎßàÎùºÏºÄÏãú"]},
    {name: "ÌéòÎ£®", capital: "Î¶¨Îßà", flag: "üáµüá™", cities: ["Î¶¨Îßà", "ÏïÑÎ†àÌÇ§Ìåå", "Ìä∏Î£®ÌûàÏöî", "ÏπòÌÅ¥ÎùºÏöî"]},
    {name: "ÌïÑÎ¶¨ÌïÄ", capital: "ÎßàÎãêÎùº", flag: "üáµüá≠", cities: ["ÎßàÎãêÎùº", "ÌÄòÏ°¥ÏãúÌã∞", "Îã§Î∞îÏò§", "ÏÑ∏Î∂Ä"]},
    {name: "Ìè¥ÎûÄÎìú", capital: "Î∞îÎ•¥ÏÉ§Î∞î", flag: "üáµüá±", cities: ["Î∞îÎ•¥ÏÉ§Î∞î", "ÌÅ¨ÎùºÏø†ÌîÑ", "Ïö∞Ïπò", "Î∏åÎ°úÏ∏†ÏôÄÌîÑ"]},
    {name: "Ìè¨Î•¥Ìà¨Í∞à", capital: "Î¶¨Ïä§Î≥∏", flag: "üáµüáπ", cities: ["Î¶¨Ïä§Î≥∏", "Ìè¨Î•¥Ìà¨", "ÏïÑÎßàÎèÑÎùº", "Î∏åÎùºÍ∞Ä"]},
    {name: "Ïπ¥ÌÉÄÎ•¥", capital: "ÎèÑÌïò", flag: "üá∂üá¶", cities: ["ÎèÑÌïò", "ÏïåÎùºÏù¥ÏñÄ", "ÏïåÏôÄÌÅ¨Îùº", "ÏõÄÏÇ¥ÎûÑÎ¨¥Ìï®ÎßàÎìú"]},
    {name: "Î£®ÎßàÎãàÏïÑ", capital: "Î∂ÄÏø†Î†àÏäàÌã∞", flag: "üá∑üá¥", cities: ["Î∂ÄÏø†Î†àÏäàÌã∞", "ÌÅ¥Î£®ÏßÄÎÇòÌè¨Ïπ¥", "Ìã∞ÎØ∏ÏáºÏïÑÎùº", "Ïù¥ÏïÑÏãú"]},
    {name: "ÏÇ¨Ïö∞ÎîîÏïÑÎùºÎπÑÏïÑ", capital: "Î¶¨ÏïºÎìú", flag: "üá∏üá¶", cities: ["Î¶¨ÏïºÎìú", "ÏßÄÎã§", "Î©îÏπ¥", "Î©îÎîîÎÇò"]},
    {name: "Ïã±Í∞ÄÌè¨Î•¥", capital: "Ïã±Í∞ÄÌè¨Î•¥", flag: "üá∏üá¨", cities: ["Ïã±Í∞ÄÌè¨Î•¥", "Ï£ºÎ°±", "Ï∞ΩÏù¥", "Ïö∞Îì§ÎûúÏ¶à"]},
    {name: "Ïö∞ÌÅ¨ÎùºÏù¥ÎÇò", capital: "ÌÇ§Ïù¥Ïö∞", flag: "üá∫üá¶", cities: ["ÌÇ§Ïù¥Ïö∞", "ÌïòÎ•¥ÌÇ§Ïö∞", "Ïò§Îç∞ÏÇ¨", "ÎìúÎãàÌîÑÎ°ú"]},
    {name: "ÏïÑÎûçÏóêÎØ∏Î¶¨Ìä∏", capital: "ÏïÑÎ∂ÄÎã§ÎπÑ", flag: "üá¶üá™", cities: ["ÏïÑÎ∂ÄÎã§ÎπÑ", "ÎëêÎ∞îÏù¥", "ÏÉ§Î•¥Ïûê", "ÏïåÏïÑÏù∏"]},
    {name: "Î≥ºÎ¶¨ÎπÑÏïÑ", capital: "ÏàòÌÅ¨Î†à", flag: "üáßüá¥", cities: ["ÏàòÌÅ¨Î†à", "ÎùºÌååÏä§", "ÏÇ∞ÌÉÄÌÅ¨Î£®Ïä§", "ÏΩîÏ∞®Î∞§Î∞î"]},
    {name: "ÌååÌÇ§Ïä§ÌÉÑ", capital: "Ïù¥Ïä¨ÎùºÎßàÎ∞îÎìú", flag: "üáµüá∞", cities: ["Ïù¥Ïä¨ÎùºÎßàÎ∞îÎìú", "Ïπ¥ÎùºÏπò", "ÎùºÌò∏Î•¥", "ÌååÏù¥ÏÇ¥ÎùºÎ∞îÎìú"]}
];

let gameState = {
    currentQuestion: 0,
    correctAnswers: 0,
    selectedCountries: [],
    userAnswers: [],
    selectedOption: null,
    currentOptions: []
};

function startGame() {
    // 3Í∞ú Íµ≠Í∞Ä ÎûúÎç§ ÏÑ†ÌÉù
    gameState.selectedCountries = getRandomCountries(3);
    gameState.currentQuestion = 0;
    gameState.correctAnswers = 0;
    gameState.userAnswers = [];
    
    showScene('quiz-scene');
    showQuestion();
}

function getRandomCountries(count) {
    const shuffled = [...countries].sort(() => 0.5 - Math.random());
    return shuffled.slice(0, count);
}

function showQuestion() {
    const country = gameState.selectedCountries[gameState.currentQuestion];
    document.getElementById('progress').textContent = `${gameState.currentQuestion + 1}/3`;
    document.getElementById('question').textContent = `${country.flag} ${country.name}Ïùò ÏàòÎèÑÎäî?`;
    
    // Í∞ùÍ¥ÄÏãù ÏÑ†ÌÉùÏßÄ ÏÉùÏÑ±
    createOptions(country);
    gameState.selectedOption = null;
    document.getElementById('submit-btn').disabled = true;
}

function createOptions(correctCountry) {
    // Ìï¥Îãπ ÎÇòÎùºÏùò Ïú†Î™ÖÌïú ÎèÑÏãú 4Í∞úÎ•º ÏÑ†ÌÉùÏßÄÎ°ú ÏÇ¨Ïö©
    const cityOptions = [...correctCountry.cities].sort(() => 0.5 - Math.random());
    
    gameState.currentOptions = cityOptions.map(city => ({
        capital: city,
        isCorrect: city === correctCountry.capital
    }));
    
    const optionsContainer = document.getElementById('options-container');
    optionsContainer.innerHTML = '';
    
    cityOptions.forEach((city, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        optionElement.onclick = () => selectOption(index);
        
        const letter = String.fromCharCode(65 + index); // A, B, C, D
        optionElement.innerHTML = `
            <span class="option-letter">${letter}</span>
            <span>${city}</span>
        `;
        
        optionsContainer.appendChild(optionElement);
    });
}

function selectOption(index) {
    // Ïù¥Ï†Ñ ÏÑ†ÌÉù Ï†úÍ±∞
    document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
    });
    
    // ÏÉà ÏÑ†ÌÉù Ï∂îÍ∞Ä
    document.querySelectorAll('.option')[index].classList.add('selected');
    gameState.selectedOption = index;
    document.getElementById('submit-btn').disabled = false;
}

function submitAnswer() {
    if (gameState.selectedOption === null) {
        alert('ÎãµÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
        return;
    }

    const country = gameState.selectedCountries[gameState.currentQuestion];
    const selectedAnswer = gameState.currentOptions[gameState.selectedOption];
    const isCorrect = selectedAnswer.isCorrect;
    
    gameState.userAnswers.push({
        country: country.name,
        userAnswer: selectedAnswer.capital,
        correctAnswer: country.capital,
        isCorrect: isCorrect
    });

    if (isCorrect) {
        gameState.correctAnswers++;
    }

    gameState.currentQuestion++;

    if (gameState.currentQuestion < 3) {
        showQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    showScene('result-scene');
    
    const resultMessage = document.getElementById('result-message');
    const couponContainer = document.getElementById('coupon-container');
    
    if (gameState.correctAnswers === 3) {
        resultMessage.innerHTML = 'üéâ ÏÑ∏Í≥Ñ Ï†ïÎ≥µÏûê! Ï∂ïÌïòÌï©ÎãàÎã§!';
        resultMessage.className = 'result-message success';
        
        couponContainer.innerHTML = `
            <div class="coupon">
                üí∞ 1,000Ïõê Ìï†Ïù∏ Ïø†Ìè∞
                <br><small>Ï∂ïÌïòÌï©ÎãàÎã§!</small>
            </div>
            <button class="btn" onclick="saveCoupon()">üì• Ïø†Ìè∞ Ï†ÄÏû•</button>
        `;
        
        createConfetti();
        playSound('success');
    } else {
        resultMessage.innerHTML = `üòÖ ${gameState.correctAnswers}Í∞ú Ï†ïÎãµ! Îã§Ïùå Í∏∞ÌöåÏóê ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!`;
        resultMessage.className = 'result-message fail';
        
        showFailAnimation();
        playSound('fail');
    }
}

function createConfetti() {
    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7'][Math.floor(Math.random() * 5)];
            confetti.style.animationDelay = Math.random() * 3 + 's';
            document.querySelector('.game-container').appendChild(confetti);
            
            setTimeout(() => {
                confetti.remove();
            }, 3000);
        }, i * 50);
    }
}

function showFailAnimation() {
    const img = document.createElement('img');
    img.src = 'ggg.png';
    img.className = 'slide-animation';
    img.style.width = '100px';
    img.style.height = '100px';
    document.querySelector('.game-container').appendChild(img);
    
    setTimeout(() => {
        img.remove();
    }, 4000);
}

function playSound(type) {
    const sound = document.getElementById(type === 'success' ? 'success-sound' : 'fail-sound');
    sound.currentTime = 0;
    sound.play().catch(e => console.log('ÏÜåÎ¶¨ Ïû¨ÏÉùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§:', e));
}

function saveCoupon() {
    // CanvasÎ°ú Ïø†Ìè∞ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    
    // Ï∫îÎ≤ÑÏä§ ÌÅ¨Í∏∞ ÏÑ§Ï†ï (Î™®Î∞îÏùº ÏπúÌôîÏ†Å)
    canvas.width = 600;
    canvas.height = 300;
    
    // Î∞∞Í≤Ω Í∑∏ÎùºÎç∞Ïù¥ÏÖò
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, '#ff6b6b');
    gradient.addColorStop(1, '#ffa500');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Ïô∏Í≥ΩÏÑ†
    ctx.strokeStyle = '#ffffff';
    ctx.lineWidth = 8;
    ctx.strokeRect(20, 20, canvas.width - 40, canvas.height - 40);
    
    // ÎÇ¥Î∂Ä Ïû•ÏãùÏÑ†
    ctx.strokeStyle = '#ffffff';
    ctx.lineWidth = 2;
    ctx.setLineDash([10, 5]);
    ctx.strokeRect(40, 40, canvas.width - 80, canvas.height - 80);
    ctx.setLineDash([]);
    
    // ÌÖçÏä§Ìä∏ ÏÑ§Ï†ï
    ctx.fillStyle = '#ffffff';
    ctx.textAlign = 'center';
    ctx.shadowColor = 'rgba(0,0,0,0.3)';
    ctx.shadowOffsetX = 2;
    ctx.shadowOffsetY = 2;
    ctx.shadowBlur = 4;
    
    // Ï†úÎ™©
    ctx.font = 'bold 48px Arial, sans-serif';
    ctx.fillText('üéâ Ï∂ïÌïòÌï©ÎãàÎã§! üéâ', canvas.width / 2, 80);
    
    // Ïø†Ìè∞ Í∏àÏï°
    ctx.font = 'bold 72px Arial, sans-serif';
    ctx.fillStyle = '#ffff00';
    ctx.strokeStyle = '#ff4444';
    ctx.lineWidth = 3;
    ctx.strokeText('‚Ç©1,000', canvas.width / 2, 150);
    ctx.fillText('‚Ç©1,000', canvas.width / 2, 150);
    
    // Ìï†Ïù∏ Ïø†Ìè∞ ÌÖçÏä§Ìä∏
    ctx.fillStyle = '#ffffff';
    ctx.font = 'bold 32px Arial, sans-serif';
    ctx.fillText('Ìï†Ïù∏ Ïø†Ìè∞', canvas.width / 2, 190);
    
    // ÌïòÎã® ÌÖçÏä§Ìä∏
    ctx.font = '20px Arial, sans-serif';
    ctx.fillText('üåç ÏàòÎèÑ ÌÄ¥Ï¶à Ï±åÎ¶∞ÏßÄ ÏôÑÏ£º Í∏∞ÎÖê', canvas.width / 2, 230);
    
    // ÎÇ†Ïßú
    const today = new Date();
    const dateStr = `${today.getFullYear()}.${(today.getMonth() + 1).toString().padStart(2, '0')}.${today.getDate().toString().padStart(2, '0')}`;
    ctx.font = '16px Arial, sans-serif';
    ctx.fillText(`Î∞úÍ∏âÏùº: ${dateStr}`, canvas.width / 2, 260);
    
    // Í∑∏Î¶ºÏûê Ï†úÍ±∞
    ctx.shadowColor = 'transparent';
    
    // Ïû•Ïãù ÏöîÏÜåÎì§
    drawStar(ctx, 80, 80, 25, '#ffff00');
    drawStar(ctx, canvas.width - 80, 80, 25, '#ffff00');
    drawStar(ctx, 80, canvas.height - 80, 25, '#ffff00');
    drawStar(ctx, canvas.width - 80, canvas.height - 80, 25, '#ffff00');
    
    // Ïù¥ÎØ∏ÏßÄ Îã§Ïö¥Î°úÎìú
    canvas.toBlob(function(blob) {
        const link = document.createElement('a');
        link.download = `ÏàòÎèÑÌÄ¥Ï¶à_Ìï†Ïù∏Ïø†Ìè∞_${dateStr}.png`;
        link.href = URL.createObjectURL(blob);
        link.click();
        URL.revokeObjectURL(link.href);
        
        // ÏÑ±Í≥µ Î©îÏãúÏßÄ
        setTimeout(() => {
            alert('üéâ Ïø†Ìè∞Ïù¥ Îã§Ïö¥Î°úÎìú Ìè¥ÎçîÏóê Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!\nÌååÏùºÎ™Ö: ' + link.download);
        }, 100);
    }, 'image/png');
}

function drawStar(ctx, x, y, size, color) {
    ctx.save();
    ctx.fillStyle = color;
    ctx.strokeStyle = '#ff4444';
    ctx.lineWidth = 2;
    ctx.translate(x, y);
    ctx.beginPath();
    
    for (let i = 0; i < 5; i++) {
        ctx.lineTo(0, -size);
        ctx.translate(0, -size);
        ctx.rotate(Math.PI / 5);
        ctx.lineTo(0, size / 2);
        ctx.translate(0, size / 2);
        ctx.rotate(Math.PI / 5);
    }
    
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
    ctx.restore();
}

function goHome() {
    showScene('start-scene');
}

function showScene(sceneId) {
    document.querySelectorAll('.scene').forEach(scene => {
        scene.classList.remove('active');
    });
    document.getElementById(sceneId).classList.add('active', 'fade-in');
}

// ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ (A, B, C, D)
document.addEventListener('keypress', function(e) {
    if (document.getElementById('quiz-scene').classList.contains('active')) {
        const key = e.key.toLowerCase();
        if (['a', 'b', 'c', 'd'].includes(key)) {
            const index = key.charCodeAt(0) - 97; // a=0, b=1, c=2, d=3
            if (index < gameState.currentOptions.length) {
                selectOption(index);
            }
        } else if (e.key === 'Enter' && gameState.selectedOption !== null) {
            submitAnswer();
        }
    }
}); 